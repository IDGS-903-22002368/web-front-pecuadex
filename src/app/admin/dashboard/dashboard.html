<div class="admin-layout">
  <aside class="sidebar" [class.collapsed]="sidebarCollapsed">
    <div class="sidebar-header">
      <img src="assets/logo-pecuadex.svg" alt="Pecuadex" class="logo" />
      <button class="btn-outline-custom" (click)="toggleSidebar()">
        <i class="fas fa-bars"></i>
      </button>
    </div>

    <nav class="sidebar-nav">
      <ul>
        <li [class.active]="activeSection === 'dashboard'">
          <a (click)="setActiveSection('dashboard')">
            <i class="fas fa-tachometer-alt"></i>
            <span>Dashboard</span>
          </a>
        </li>
        <li [class.active]="activeSection === 'productos'">
          <a (click)="setActiveSection('productos')">
            <i class="fas fa-box"></i>
            <span>Productos</span>
          </a>
        </li>
        <li [class.active]="activeSection === 'inventario'">
          <a (click)="setActiveSection('inventario')">
            <i class="fas fa-warehouse"></i>
            <span>Inventario</span>
          </a>
        </li>
        <li [class.active]="activeSection === 'ventas'">
          <a (click)="setActiveSection('ventas')">
            <i class="fas fa-shopping-cart"></i>
            <span>Ventas</span>
          </a>
        </li>
        <li [class.active]="activeSection === 'compras'">
          <a (click)="setActiveSection('compras')">
            <i class="fas fa-truck"></i>
            <span>Compras</span>
          </a>
        </li>
        <li [class.active]="activeSection === 'proveedores'">
          <a (click)="setActiveSection('proveedores')">
            <i class="fas fa-handshake"></i>
            <span>Proveedores</span>
          </a>
        </li>
        <li [class.active]="activeSection === 'usuarios'">
          <a (click)="setActiveSection('usuarios')">
            <i class="fas fa-users"></i>
            <span>Usuarios</span>
          </a>
        </li>
        <li [class.active]="activeSection === 'cotizaciones'">
          <a (click)="setActiveSection('cotizaciones')">
            <i class="fas fa-file-invoice-dollar"></i>
            <span>Cotizaciones</span>
          </a>
        </li>
        <li [class.active]="activeSection === 'reportes'">
          <a (click)="setActiveSection('reportes')">
            <i class="fas fa-chart-bar"></i>
            <span>Reportes</span>
          </a>
        </li>
      </ul>
    </nav>

    <div class="sidebar-footer">
      <div class="user-info">
        <img src="assets/avatar-default.png" alt="User" class="avatar" />
        <div class="user-details" *ngIf="currentUser">
          <span class="name">{{ currentUser.fullName }}</span>
          <span class="role">Administrador</span>
        </div>
      </div>
      <button class="btn-outline-custom" (click)="logout()">
        <i class="fas fa-sign-out-alt"></i>
      </button>
    </div>
  </aside>

  <main class="main-content">
    <header class="admin-header navbar-scrolled">
      <div class="header-left">
        <h1>{{ getSectionTitle() }}</h1>
        <nav class="breadcrumb">
          <a routerLink="/admin">Admin</a>
          <span>/</span>
          <span>{{ getSectionTitle() }}</span>
        </nav>
      </div>

      <div class="header-right">
        <button class="btn-outline-custom">
          <i class="fas fa-bell"></i>
          <span class="badge">3</span>
        </button>

        <button class="btn-outline-custom">
          <i class="fas fa-cog"></i>
        </button>
      </div>
    </header>

    <section *ngIf="activeSection === 'productos'" class="products-section">
      <div class="section-header">
        <h2>Gestión de Productos</h2>
        <button class="btn-primary-custom" (click)="openProductModal()">
          <i class="fas fa-plus"></i> Nuevo Producto
        </button>
      </div>

      <div class="table-card card-custom">
        <div class="table-header">
          <div class="form-modern w-100">
            <input
              type="text"
              class="form-control search-input"
              placeholder="Buscar productos..."
              [(ngModel)]="searchTerm"
            />
          </div>
          <div class="table-actions">
            <button class="btn-outline-custom btn-sm">
              <i class="fas fa-filter"></i> Filtros
            </button>
            <button class="btn-outline-custom btn-sm">
              <i class="fas fa-download"></i> Exportar
            </button>
          </div>
        </div>

        <table class="table table-modern">
          <thead>
            <tr>
              <th>ID</th>
              <th>Imagen</th>
              <th>Nombre</th>
              <th>Descripción</th>
              <th>Precio</th>
              <th>Stock</th>
              <th>Estado</th>
              <th>Acciones</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let producto of productos">
              <td>#{{ producto.id }}</td>
              <td>
                <img
                  [src]="producto.imagen"
                  [alt]="producto.nombre"
                  class="product-thumb"
                />
              </td>
              <td>{{ producto.nombre }}</td>
              <td>{{ producto.descripcion | slice:0:50 }}...</td>
              <td>${{ producto.precioSugerido | number:'1.2-2' }}</td>
              <td>
                <span class="badge" [ngClass]="getStockClass(producto.stock)">
                  {{ producto.stock }} unidades
                </span>
              </td>
              <td>
                <span class="badge bg-success">Activo</span>
              </td>
              <td>
                <div class="action-buttons">
                  <button class="btn-outline-custom btn-sm" title="Ver">
                    <i class="fas fa-eye"></i>
                  </button>
                  <button class="btn-outline-custom btn-sm" title="Editar">
                    <i class="fas fa-edit"></i>
                  </button>
                  <button class="btn-outline-custom btn-sm" title="Eliminar">
                    <i class="fas fa-trash"></i>
                  </button>
                </div>
              </td>
            </tr>
          </tbody>
        </table>

        <div class="table-footer">
          <div class="pagination-info">
            Mostrando 1-10 de {{ productos.length }} productos
          </div>
          <nav>
            <ul class="pagination">
              <li class="page-item disabled">
                <a class="page-link">Anterior</a>
              </li>
              <li class="page-item active">
                <a class="page-link">1</a>
              </li>
              <li class="page-item">
                <a class="page-link">2</a>
              </li>
              <li class="page-item">
                <a class="page-link">3</a>
              </li>
              <li class="page-item">
                <a class="page-link">Siguiente</a>
              </li>
            </ul>
          </nav>
        </div>
      </div>
    </section>
  </main>
</div>

<div class="modal" *ngIf="showProductModal">
  <div class="modal-dialog">
    <div class="modal-content card-custom">
      <div class="modal-header">
        <h5 class="modal-title">Nuevo Producto</h5>
        <button class="btn-close" (click)="closeProductModal()"></button>
      </div>
      <div class="modal-body form-modern">
        <form [formGroup]="productForm">
          <div class="mb-3">
            <label class="form-label">Nombre del Producto</label>
            <input type="text" class="form-control" formControlName="nombre" />
          </div>
          <div class="mb-3">
            <label class="form-label">Descripción</label>
            <textarea
              class="form-control"
              rows="3"
              formControlName="descripcion"
            ></textarea>
          </div>
          <div class="row">
            <div class="col-md-6 mb-3">
              <label class="form-label">Precio Sugerido</label>
              <input
                type="number"
                class="form-control"
                formControlName="precioSugerido"
              />
            </div>
            <div class="col-md-6 mb-3">
              <label class="form-label">Stock Inicial</label>
              <input
                type="number"
                class="form-control"
                formControlName="stock"
              />
            </div>
          </div>
          <div class="mb-3">
            <label class="form-label">Imagen del Producto</label>
            <input
              type="file"
              class="form-control"
              (change)="onImageSelected($event)"
            />
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button class="btn-outline-custom" (click)="closeProductModal()">
          Cancelar
        </button>
        <button class="btn-primary-custom" (click)="saveProduct()">
          Guardar Producto
        </button>
      </div>
    </div>
  </div>
</div>
