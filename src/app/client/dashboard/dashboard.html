<!--
<div class="client-layout">
  <header class="client-header">
    <div class="container-fluid">
      <div class="header-content">
        <div class="header-left">
          <img src="assets/logo-pecuadex.svg" alt="Pecuadex" class="logo" />
          <button class="menu-toggle d-lg-none" (click)="toggleMobileMenu()">
            <i class="fas fa-bars"></i>
          </button>
        </div>

        <nav class="header-nav" [class.mobile-open]="mobileMenuOpen">
          <a
            [class.active]="activeTab === 'dashboard'"
            (click)="setActiveTab('dashboard')"
          >
            <i class="fas fa-home"></i> Dashboard
          </a>
          <a
            [class.active]="activeTab === 'dispositivos'"
            (click)="setActiveTab('dispositivos')"
          >
            <i class="fas fa-satellite-dish"></i> Mis Dispositivos
          </a>
          <a
            [class.active]="activeTab === 'compras'"
            (click)="setActiveTab('compras')"
          >
            <i class="fas fa-shopping-bag"></i> Mis Compras
          </a>
          <a
            [class.active]="activeTab === 'manuales'"
            (click)="setActiveTab('manuales')"
          >
            <i class="fas fa-book"></i> Documentación
          </a>
          <a
            [class.active]="activeTab === 'soporte'"
            (click)="setActiveTab('soporte')"
          >
            <i class="fas fa-headset"></i> Soporte
          </a>
        </nav>

        <div class="header-right">
          <button class="notification-btn">
            <i class="fas fa-bell"></i>
            <span class="badge" *ngIf="notifications > 0"
              >{{ notifications }}</span
            >
          </button>

          <div class="user-menu" (click)="toggleUserMenu()">
            <img
              [src]="currentUser?.avatar || 'assets/avatar-default.png'"
              alt="User"
              class="user-avatar"
            />
            <span class="user-name">{{ currentUser?.fullName }}</span>
            <i class="fas fa-chevron-down"></i>

            <div class="dropdown-menu" *ngIf="userMenuOpen">
              <a routerLink="/client/profile">
                <i class="fas fa-user"></i> Mi Perfil
              </a>
              <a routerLink="/client/settings">
                <i class="fas fa-cog"></i> Configuración
              </a>
              <hr />
              <a (click)="logout()">
                <i class="fas fa-sign-out-alt"></i> Cerrar Sesión
              </a>
            </div>
          </div>
        </div>
      </div>
    </div>
  </header>

  <main class="client-main">
    <section *ngIf="activeTab === 'dashboard'" class="dashboard-tab">
      <div class="container">
        <div class="welcome-section">
          <h1>Bienvenido, {{ currentUser?.fullName }}</h1>
          <p>Aquí puedes monitorear todos tus dispositivos Pecuadex GPS</p>
        </div>

        <div class="quick-stats">
          <div class="stat-card gradient-primary">
            <div class="stat-icon">
              <i class="fas fa-satellite-dish"></i>
            </div>
            <div class="stat-info">
              <h3>{{ userStats.totalDevices }}</h3>
              <p>Dispositivos Totales</p>
            </div>
          </div>

          <div class="stat-card gradient-success">
            <div class="stat-icon">
              <i class="fas fa-check-circle"></i>
            </div>
            <div class="stat-info">
              <h3>{{ userStats.activeDevices }}</h3>
              <p>Dispositivos Activos</p>
            </div>
          </div>

          <div class="stat-card gradient-warning">
            <div class="stat-icon">
              <i class="fas fa-cow"></i>
            </div>
            <div class="stat-info">
              <h3>{{ userStats.totalAnimals }}</h3>
              <p>Animales Monitoreados</p>
            </div>
          </div>

          <div class="stat-card gradient-info">
            <div class="stat-icon">
              <i class="fas fa-bell"></i>
            </div>
            <div class="stat-info">
              <h3>{{ userStats.alerts }}</h3>
              <p>Alertas Hoy</p>
            </div>
          </div>
        </div>

        <div class="map-section">
          <div class="section-header">
            <h2><i class="fas fa-map-marked-alt"></i> Mapa en Tiempo Real</h2>
            <button class="btn btn-primary btn-sm">
              <i class="fas fa-expand"></i> Pantalla Completa
            </button>
          </div>
          <div class="map-container">
            <div id="liveMap" class="live-map">
              <div class="map-placeholder">
                <i class="fas fa-map"></i>
                <p>Mapa interactivo de tus dispositivos</p>
              </div>
            </div>
            <div class="map-controls">
              <button class="map-btn" title="Zoom In">
                <i class="fas fa-plus"></i>
              </button>
              <button class="map-btn" title="Zoom Out">
                <i class="fas fa-minus"></i>
              </button>
              <button class="map-btn" title="Mi Ubicación">
                <i class="fas fa-crosshairs"></i>
              </button>
              <button class="map-btn" title="Capas">
                <i class="fas fa-layer-group"></i>
              </button>
            </div>
          </div>
        </div>

        <div class="alerts-section">
          <div class="section-header">
            <h2>
              <i class="fas fa-exclamation-triangle"></i> Alertas Recientes
            </h2>
            <a class="view-all">Ver todas →</a>
          </div>
          <div class="alerts-list">
            <div class="alert-item" *ngFor="let alert of recentAlerts">
              <div class="alert-icon" [ngClass]="'alert-' + alert.type">
                <i [class]="alert.icon"></i>
              </div>
              <div class="alert-content">
                <h5>{{ alert.title }}</h5>
                <p>{{ alert.description }}</p>
                <small
                  >{{ alert.time }} - Dispositivo: {{ alert.device }}</small
                >
              </div>
              <button class="alert-action">
                <i class="fas fa-arrow-right"></i>
              </button>
            </div>
          </div>
        </div>
      </div>
    </section>

    <section *ngIf="activeTab === 'dispositivos'" class="devices-tab">
      <div class="container">
        <div class="section-header">
          <h2>Mis Dispositivos GPS</h2>
          <button class="btn btn-primary" (click)="openDeviceModal()">
            <i class="fas fa-plus"></i> Agregar Dispositivo
          </button>
        </div>

        <div class="devices-filters">
          <input
            type="text"
            class="form-control"
            placeholder="Buscar dispositivo..."
            [(ngModel)]="deviceSearch"
          />
          <select class="form-select" [(ngModel)]="deviceFilter">
            <option value="all">Todos</option>
            <option value="active">Activos</option>
            <option value="inactive">Inactivos</option>
            <option value="maintenance">En Mantenimiento</option>
          </select>
        </div>

        <div class="devices-grid">
          <div class="device-card" *ngFor="let device of filteredDevices">
            <div class="device-header">
              <span
                class="device-status"
                [class.active]="device.isActive"
              ></span>
              <h4>{{ device.name }}</h4>
              <button class="device-menu">
                <i class="fas fa-ellipsis-v"></i>
              </button>
            </div>

            <div class="device-info">
              <div class="info-row">
                <span class="label">ID:</span>
                <span class="value">{{ device.id }}</span>
              </div>
              <div class="info-row">
                <span class="label">Animal:</span>
                <span class="value">{{ device.animalName }}</span>
              </div>
              <div class="info-row">
                <span class="label">Batería:</span>
                <div class="battery-indicator">
                  <div
                    class="battery-level"
                    [style.width.%]="device.battery"
                  ></div>
                </div>
                <span class="value">{{ device.battery }}%</span>
              </div>
              <div class="info-row">
                <span class="label">Última Actualización:</span>
                <span class="value"
                  >{{ device.lastUpdate | date:'short' }}</span
                >
              </div>
            </div>

            <div class="device-location">
              <i class="fas fa-map-marker-alt"></i>
              <span>{{ device.location }}</span>
            </div>

            <div class="device-actions">
              <button
                class="btn btn-sm btn-outline-primary"
                (click)="viewDeviceDetails(device)"
              >
                <i class="fas fa-eye"></i> Ver Detalles
              </button>
              <button
                class="btn btn-sm btn-outline-secondary"
                (click)="configureDevice(device)"
              >
                <i class="fas fa-cog"></i> Configurar
              </button>
            </div>
          </div>
        </div>
      </div>
    </section>

    <section *ngIf="activeTab === 'compras'" class="purchases-tab">
      <div class="container">
        <div class="section-header">
          <h2>Historial de Compras</h2>
          <button class="btn btn-success" routerLink="/productos">
            <i class="fas fa-shopping-cart"></i> Nueva Compra
          </button>
        </div>

        <div class="purchases-list">
          <div class="purchase-card" *ngFor="let purchase of userPurchases">
            <div class="purchase-header">
              <div>
                <h4>Orden #{{ purchase.id }}</h4>
                <p class="purchase-date">
                  {{ purchase.fecha | date:'fullDate' }}
                </p>
              </div>
              <div class="purchase-status">
                <span
                  class="badge"
                  [ngClass]="'bg-' + getStatusColor(purchase.estado)"
                >
                  {{ purchase.estado }}
                </span>
              </div>
            </div>

            <div class="purchase-items">
              <div class="item" *ngFor="let item of purchase.items">
                <img [src]="item.imagen" [alt]="item.nombre" />
                <div class="item-details">
                  <h5>{{ item.nombre }}</h5>
                  <p>
                    Cantidad: {{ item.cantidad }} | Precio: ${{ item.precio |
                    number:'1.2-2' }}
                  </p>
                </div>
              </div>
            </div>

            <div class="purchase-footer">
              <div class="purchase-total">
                <span>Total:</span>
                <strong>${{ purchase.total | number:'1.2-2' }}</strong>
              </div>
              <div class="purchase-actions">
                <button
                  class="btn btn-sm btn-outline-primary"
                  (click)="viewInvoice(purchase)"
                >
                  <i class="fas fa-file-invoice"></i> Ver Factura
                </button>
                <button
                  class="btn btn-sm btn-outline-secondary"
                  (click)="leaveReview(purchase)"
                >
                  <i class="fas fa-star"></i> Dejar Reseña
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <section *ngIf="activeTab === 'manuales'" class="manuals-tab">
      <div class="container">
        <div class="section-header">
          <h2>Documentación y Manuales</h2>
        </div>

        <div class="manuals-categories">
          <button class="category-btn active">Todos</button>
          <button class="category-btn">Guías de Inicio</button>
          <button class="category-btn">Manuales Técnicos</button>
          <button class="category-btn">Videos Tutoriales</button>
          <button class="category-btn">Preguntas Frecuentes</button>
        </div>

        <div class="manuals-grid">
          <div class="manual-card" *ngFor="let manual of userManuals">
            <div class="manual-icon">
              <i [class]="getManualIcon(manual.tipo)"></i>
            </div>
            <h4>{{ manual.titulo }}</h4>
            <p>{{ manual.descripcion }}</p>
            <div class="manual-meta">
              <span><i class="fas fa-file"></i> {{ manual.formato }}</span>
              <span
                ><i class="fas fa-download"></i> {{ manual.descargas }}</span
              >
            </div>
            <button
              class="btn btn-primary btn-sm"
              (click)="downloadManual(manual)"
            >
              <i class="fas fa-download"></i> Descargar
            </button>
          </div>
        </div>
      </div>
    </section>

    <section *ngIf="activeTab === 'soporte'" class="support-tab">
      <div class="container">
        <div class="section-header">
          <h2>Centro de Soporte</h2>
        </div>

        <div class="support-options">
          <div class="support-card">
            <div class="support-icon bg-primary">
              <i class="fas fa-comments"></i>
            </div>
            <h4>Chat en Vivo</h4>
            <p>Habla con un agente en tiempo real</p>
            <button class="btn btn-primary" (click)="openChat()">
              Iniciar Chat
            </button>
          </div>

          <div class="support-card">
            <div class="support-icon bg-success">
              <i class="fas fa-ticket-alt"></i>
            </div>
            <h4>Tickets de Soporte</h4>
            <p>Crea y gestiona tus tickets</p>
            <button class="btn btn-success" (click)="createTicket()">
              Nuevo Ticket
            </button>
          </div>

          <div class="support-card">
            <div class="support-icon bg-info">
              <i class="fas fa-phone"></i>
            </div>
            <h4>Soporte Telefónico</h4>
            <p>Llámanos al +52 (477) 123-4568</p>
            <button class="btn btn-info">
              <i class="fas fa-phone"></i> Llamar Ahora
            </button>
          </div>

          <div class="support-card">
            <div class="support-icon bg-warning">
              <i class="fas fa-question-circle"></i>
            </div>
            <h4>Base de Conocimiento</h4>
            <p>Encuentra respuestas rápidas</p>
            <button class="btn btn-warning" routerLink="/faq">Ver FAQs</button>
          </div>
        </div>

        <div class="tickets-section">
          <h3>Mis Tickets Recientes</h3>
          <div class="tickets-list">
            <div class="ticket-item" *ngFor="let ticket of userTickets">
              <div class="ticket-info">
                <h5>#{{ ticket.id }} - {{ ticket.subject }}</h5>
                <p>{{ ticket.lastMessage }}</p>
                <small
                  >Actualizado: {{ ticket.updatedAt | date:'short' }}</small
                >
              </div>
              <div class="ticket-status">
                <span
                  class="badge"
                  [ngClass]="'bg-' + getTicketStatusColor(ticket.status)"
                >
                  {{ ticket.status }}
                </span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
  </main>
</div>

<div class="modal" *ngIf="showDeviceModal">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">
          {{ editingDevice ? 'Configurar Dispositivo' : 'Agregar Nuevo
          Dispositivo' }}
        </h5>
        <button class="btn-close" (click)="closeDeviceModal()"></button>
      </div>
      <div class="modal-body">
        <form [formGroup]="deviceForm">
          <div class="row">
            <div class="col-md-6 mb-3">
              <label class="form-label">Nombre del Dispositivo</label>
              <input type="text" class="form-control" formControlName="name" />
            </div>
            <div class="col-md-6 mb-3">
              <label class="form-label">ID del Dispositivo</label>
              <input
                type="text"
                class="form-control"
                formControlName="deviceId"
              />
            </div>
          </div>

          <div class="row">
            <div class="col-md-6 mb-3">
              <label class="form-label">Animal Asignado</label>
              <select class="form-select" formControlName="animalId">
                <option value="">Seleccionar...</option>
                <option *ngFor="let animal of userAnimals" [value]="animal.id">
                  {{ animal.name }} - {{ animal.tag }}
                </option>
              </select>
            </div>
            <div class="col-md-6 mb-3">
              <label class="form-label">Zona Asignada</label>
              <select class="form-select" formControlName="zoneId">
                <option value="">Seleccionar...</option>
                <option *ngFor="let zone of userZones" [value]="zone.id">
                  {{ zone.name }}
                </option>
              </select>
            </div>
          </div>

          <div class="mb-3">
            <label class="form-label">Configuración de Alertas</label>
            <div class="form-check">
              <input
                class="form-check-input"
                type="checkbox"
                formControlName="alertOutOfZone"
              />
              <label class="form-check-label">
                Alertar cuando salga de la zona
              </label>
            </div>
            <div class="form-check">
              <input
                class="form-check-input"
                type="checkbox"
                formControlName="alertLowBattery"
              />
              <label class="form-check-label">
                Alertar con batería baja (< 20%)
              </label>
            </div>
            <div class="form-check">
              <input
                class="form-check-input"
                type="checkbox"
                formControlName="alertNoMovement"
              />
              <label class="form-check-label">
                Alertar si no hay movimiento en 24 horas
              </label>
            </div>
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" (click)="closeDeviceModal()">
          Cancelar
        </button>
        <button class="btn btn-primary" (click)="saveDevice()">
          {{ editingDevice ? 'Guardar Cambios' : 'Agregar Dispositivo' }}
        </button>
      </div>
    </div>
  </div>
</div>
-->
